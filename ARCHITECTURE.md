# é¡¹ç›®æ¶æ„è¯´æ˜

## æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Telegram Bot æ¶æ„å›¾                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Telegram     â”‚
â”‚ ç¾¤ç»„æ¶ˆæ¯     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      bot.py (ä¸»ç¨‹åº)                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ â€¢ æ¥æ”¶æ¶ˆæ¯                                              â”‚  â”‚
â”‚  â”‚ â€¢ å‘½ä»¤å¤„ç† (/start, /help, /status)                    â”‚  â”‚
â”‚  â”‚ â€¢ é”™è¯¯å¤„ç†                                              â”‚  â”‚
â”‚  â”‚ â€¢ é€šçŸ¥ç®¡ç†                                              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              spam_detector.py (æ£€æµ‹æ¨¡å—)                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ â€¢ æ¶ˆæ¯å†…å®¹æå–                                          â”‚  â”‚
â”‚  â”‚ â€¢ ç®¡ç†å‘˜ç™½åå•æ£€æŸ¥                                      â”‚  â”‚
â”‚  â”‚ â€¢ æ–°æˆå‘˜æ£€æµ‹                                            â”‚  â”‚
â”‚  â”‚ â€¢ è°ƒç”¨ LLM åˆ†æ                                         â”‚  â”‚
â”‚  â”‚ â€¢ åˆ¤æ–­æ˜¯å¦åˆ é™¤/å°ç¦                                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                llm_api.py (LLM è°ƒç”¨æ¨¡å—)                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ â€¢ æ„å»ºæ£€æµ‹æç¤ºè¯                                        â”‚  â”‚
â”‚  â”‚ â€¢ è°ƒç”¨ LLM API                                          â”‚  â”‚
â”‚  â”‚ â€¢ è§£æ JSON å“åº”                                        â”‚  â”‚
â”‚  â”‚ â€¢ é”™è¯¯å¤„ç†å’Œé‡è¯•                                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     LLM API æœåŠ¡                              â”‚
â”‚  (OpenAI / Claude / æ™ºè°± AI / DeepSeek / ...)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    config.py (é…ç½®æ¨¡å—)                       â”‚
â”‚  â€¢ ç¯å¢ƒå˜é‡åŠ è½½                                               â”‚
â”‚  â€¢ é…ç½®éªŒè¯                                                   â”‚
â”‚  â€¢ æç¤ºè¯æ¨¡æ¿                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ–‡ä»¶ç»“æ„è¯´æ˜

```
bot/
â”œâ”€â”€ ğŸ“„ æ ¸å¿ƒæ–‡ä»¶
â”‚   â”œâ”€â”€ bot.py                  # ä¸»ç¨‹åºå…¥å£ï¼Œå¤„ç† Telegram æ¶ˆæ¯
â”‚   â”œâ”€â”€ config.py               # é…ç½®ç®¡ç†ï¼Œç¯å¢ƒå˜é‡åŠ è½½
â”‚   â”œâ”€â”€ llm_api.py             # LLM API è°ƒç”¨å°è£…
â”‚   â””â”€â”€ spam_detector.py       # åƒåœ¾æ¶ˆæ¯æ£€æµ‹é€»è¾‘
â”‚
â”œâ”€â”€ ğŸ“„ é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ .env.example           # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â”‚   â”œâ”€â”€ requirements.txt       # Python ä¾èµ–
â”‚   â”œâ”€â”€ .gitignore            # Git å¿½ç•¥æ–‡ä»¶
â”‚   â””â”€â”€ runtime.txt           # Python è¿è¡Œæ—¶ç‰ˆæœ¬ï¼ˆHerokuï¼‰
â”‚
â”œâ”€â”€ ğŸ“„ Docker ç›¸å…³
â”‚   â”œâ”€â”€ Dockerfile            # Docker é•œåƒæ„å»ºæ–‡ä»¶
â”‚   â”œâ”€â”€ docker-compose.yml    # Docker Compose é…ç½®
â”‚   â””â”€â”€ Procfile             # Heroku/Railway éƒ¨ç½²æ–‡ä»¶
â”‚
â”œâ”€â”€ ğŸ“„ å¯åŠ¨è„šæœ¬
â”‚   â”œâ”€â”€ start.sh             # Linux/macOS å¯åŠ¨è„šæœ¬
â”‚   â”œâ”€â”€ start.bat            # Windows å¯åŠ¨è„šæœ¬
â”‚   â””â”€â”€ test_bot.py          # æµ‹è¯•è„šæœ¬
â”‚
â”œâ”€â”€ ğŸ“„ æ–‡æ¡£
â”‚   â”œâ”€â”€ README.md            # é¡¹ç›®ä»‹ç»å’ŒåŸºç¡€è¯´æ˜
â”‚   â”œâ”€â”€ QUICKSTART.md        # å¿«é€Ÿå¼€å§‹æŒ‡å—
â”‚   â”œâ”€â”€ DEPLOYMENT.md        # éƒ¨ç½²æŒ‡å—
â”‚   â”œâ”€â”€ FAQ.md              # å¸¸è§é—®é¢˜è§£ç­”
â”‚   â”œâ”€â”€ ARCHITECTURE.md     # æœ¬æ–‡ä»¶ï¼Œæ¶æ„è¯´æ˜
â”‚   â””â”€â”€ LICENSE             # å¼€æºè®¸å¯è¯
â”‚
â””â”€â”€ ğŸ“ è¿è¡Œæ—¶ç”Ÿæˆ
    â”œâ”€â”€ venv/               # Python è™šæ‹Ÿç¯å¢ƒ
    â”œâ”€â”€ logs/              # æ—¥å¿—æ–‡ä»¶
    â””â”€â”€ .env               # å®é™…ç¯å¢ƒå˜é‡ï¼ˆä¸æäº¤åˆ° Gitï¼‰
```

## æ•°æ®æµç¨‹

### 1. æ¶ˆæ¯æ¥æ”¶æµç¨‹

```
Telegram ç¾¤ç»„æ¶ˆæ¯
    â”‚
    â–¼
bot.py: handle_message()
    â”‚
    â”œâ”€â–º æ£€æŸ¥æ¶ˆæ¯ç±»å‹ï¼ˆç¾¤ç»„/ç§èŠï¼‰
    â”‚
    â–¼
spam_detector.check_message()
    â”‚
    â”œâ”€â–º æ£€æŸ¥æ˜¯å¦ä¸ºç®¡ç†å‘˜ â†’ è·³è¿‡
    â”œâ”€â–º æ£€æŸ¥æ˜¯å¦ä¸ºæœºå™¨äºº â†’ è·³è¿‡
    â”œâ”€â–º æå–æ¶ˆæ¯æ–‡æœ¬
    â”‚
    â–¼
llm_api.analyze_message()
    â”‚
    â”œâ”€â–º æ„å»ºæç¤ºè¯
    â”œâ”€â–º è°ƒç”¨ LLM API
    â”œâ”€â–º è§£æ JSON å“åº”
    â”‚
    â–¼
è¿”å›æ£€æµ‹ç»“æœ
    â”‚
    â”œâ”€â–º is_spam: true/false
    â”œâ”€â–º confidence: 0.0-1.0
    â”œâ”€â–º reason: åˆ¤æ–­ç†ç”±
    â””â”€â–º category: åƒåœ¾ç±»å‹
    â”‚
    â–¼
bot.py: å¤„ç†ç»“æœ
    â”‚
    â”œâ”€â–º å¦‚æœæ˜¯åƒåœ¾æ¶ˆæ¯ ä¸” ç½®ä¿¡åº¦ >= é˜ˆå€¼
    â”‚   â”‚
    â”‚   â”œâ”€â–º åˆ é™¤æ¶ˆæ¯
    â”‚   â”œâ”€â–º å°ç¦ç”¨æˆ·
    â”‚   â””â”€â–º å‘é€é€šçŸ¥ï¼ˆ10ç§’åè‡ªåŠ¨åˆ é™¤ï¼‰
    â”‚
    â””â”€â–º å¦åˆ™è·³è¿‡
```

### 2. LLM API è°ƒç”¨æµç¨‹

```
spam_detector è¯·æ±‚åˆ†æ
    â”‚
    â–¼
llm_api.analyze_message()
    â”‚
    â”œâ”€â–º 1. æ„å»ºä¸Šä¸‹æ–‡ä¿¡æ¯
    â”‚      - æ¶ˆæ¯æ–‡æœ¬
    â”‚      - ç”¨æˆ·ä¿¡æ¯
    â”‚      - æ˜¯å¦æ–°æˆå‘˜
    â”‚
    â”œâ”€â–º 2. æ ¼å¼åŒ–æç¤ºè¯
    â”‚      - ä½¿ç”¨ SPAM_DETECTION_PROMPT æ¨¡æ¿
    â”‚      - æ³¨å…¥æ¶ˆæ¯å’Œç”¨æˆ·ä¿¡æ¯
    â”‚
    â”œâ”€â–º 3. è°ƒç”¨ OpenAI å…¼å®¹ API
    â”‚      - POST /v1/chat/completions
    â”‚      - è¯·æ±‚ JSON æ ¼å¼å“åº”
    â”‚
    â”œâ”€â–º 4. è§£æå“åº”
    â”‚      - æå– JSON æ•°æ®
    â”‚      - éªŒè¯å¿…éœ€å­—æ®µ
    â”‚      - ç±»å‹è½¬æ¢
    â”‚
    â”œâ”€â–º 5. é”™è¯¯å¤„ç†
    â”‚      - API è°ƒç”¨å¤±è´¥ â†’ è¿”å›é»˜è®¤å€¼
    â”‚      - JSON è§£æå¤±è´¥ â†’ è¿”å›é»˜è®¤å€¼
    â”‚      - è¶…æ—¶ â†’ è¿”å›é»˜è®¤å€¼
    â”‚
    â””â”€â–º è¿”å›ç»“æœ
```

## æ ¸å¿ƒæ¨¡å—è¯¦è§£

### 1. bot.py - ä¸»ç¨‹åº

**èŒè´£ï¼š**
- Telegram Bot åˆå§‹åŒ–å’Œç®¡ç†
- å‘½ä»¤å¤„ç†ï¼ˆ/start, /help, /statusï¼‰
- æ¶ˆæ¯äº‹ä»¶ç›‘å¬
- æ‰§è¡Œåˆ é™¤å’Œå°ç¦æ“ä½œ
- é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•

**å…³é”®å‡½æ•°ï¼š**
- `main()`: ç¨‹åºå…¥å£ï¼Œåˆå§‹åŒ– Bot
- `handle_message()`: å¤„ç†æ‰€æœ‰ç¾¤ç»„æ¶ˆæ¯
- `start_command()`: å¤„ç† /start å‘½ä»¤
- `help_command()`: å¤„ç† /help å‘½ä»¤
- `status_command()`: å¤„ç† /status å‘½ä»¤
- `error_handler()`: å…¨å±€é”™è¯¯å¤„ç†

### 2. spam_detector.py - æ£€æµ‹æ¨¡å—

**èŒè´£ï¼š**
- å°è£…åƒåœ¾æ¶ˆæ¯æ£€æµ‹é€»è¾‘
- ç®¡ç†ç™½åå•æ£€æŸ¥
- æå–å’Œå¤„ç†æ¶ˆæ¯å†…å®¹
- è°ƒç”¨ LLM è¿›è¡Œåˆ†æ
- è¿”å›æ£€æµ‹ç»“æœå’Œå»ºè®®æ“ä½œ

**å…³é”®ç±»/å‡½æ•°ï¼š**
- `SpamDetector`: æ£€æµ‹å™¨ç±»
- `check_message()`: ä¸»æ£€æµ‹æ–¹æ³•
- `_extract_message_text()`: æå–æ¶ˆæ¯æ–‡æœ¬
- `_is_new_member_message()`: åˆ¤æ–­æ˜¯å¦ä¸ºæ–°æˆå‘˜

### 3. llm_api.py - LLM è°ƒç”¨æ¨¡å—

**èŒè´£ï¼š**
- å°è£… LLM API è°ƒç”¨
- æ„å»ºå’Œæ ¼å¼åŒ–æç¤ºè¯
- å¤„ç† API å“åº”
- é”™è¯¯å¤„ç†å’Œé™çº§

**å…³é”®ç±»/å‡½æ•°ï¼š**
- `LLMClient`: LLM å®¢æˆ·ç«¯ç±»
- `analyze_message()`: åˆ†ææ¶ˆæ¯æ–¹æ³•
- `_get_default_result()`: è·å–é»˜è®¤ç»“æœï¼ˆå¤±è´¥æ—¶ï¼‰

### 4. config.py - é…ç½®æ¨¡å—

**èŒè´£ï¼š**
- åŠ è½½ç¯å¢ƒå˜é‡
- å®šä¹‰é…ç½®å¸¸é‡
- æç¤ºè¯æ¨¡æ¿ç®¡ç†
- é…ç½®éªŒè¯

**å…³é”®é…ç½®ï¼š**
- `TELEGRAM_BOT_TOKEN`: Bot Token
- `LLM_API_KEY`: LLM API å¯†é’¥
- `LLM_MODEL`: ä½¿ç”¨çš„æ¨¡å‹
- `CONFIDENCE_THRESHOLD`: ç½®ä¿¡åº¦é˜ˆå€¼
- `SPAM_DETECTION_PROMPT`: æ£€æµ‹æç¤ºè¯

## æ‰©å±•ç‚¹

### 1. æ·»åŠ æ–°çš„æ£€æµ‹è§„åˆ™

åœ¨ `spam_detector.py` ä¸­æ·»åŠ é¢„æ£€æµ‹é€»è¾‘ï¼š

```python
def check_message(self, message: Message):
    # æ·»åŠ å…³é”®è¯é»‘åå•æ£€æŸ¥
    if self._check_blacklist(message_text):
        return {
            "should_delete": True,
            "should_ban": True,
            "result": {"reason": "å‘½ä¸­é»‘åå•"},
            "skip_reason": None
        }
    
    # ç»§ç»­ LLM æ£€æµ‹...
```

### 2. æ·»åŠ æ•°æ®åº“è®°å½•

åˆ›å»º `database.py`ï¼š

```python
import sqlite3

class Database:
    def log_detection(self, user_id, is_spam, confidence):
        # è®°å½•æ£€æµ‹ç»“æœ
        pass
    
    def get_statistics(self):
        # è·å–ç»Ÿè®¡ä¿¡æ¯
        pass
```

### 3. æ·»åŠ  Web ç®¡ç†ç•Œé¢

ä½¿ç”¨ Flask æˆ– FastAPI åˆ›å»ºç®¡ç†é¢æ¿ï¼š

```python
from flask import Flask, render_template

app = Flask(__name__)

@app.route('/dashboard')
def dashboard():
    # æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯
    pass
```

### 4. æ·»åŠ å›¾ç‰‡å†…å®¹æ£€æµ‹

ä½¿ç”¨ OCR æˆ–å›¾ç‰‡åˆ†ç±»æ¨¡å‹ï¼š

```python
async def analyze_image(self, image_file):
    # ä½¿ç”¨ GPT-4V æˆ–å…¶ä»–è§†è§‰æ¨¡å‹
    pass
```

### 5. æ·»åŠ ç”¨æˆ·è¡Œä¸ºåˆ†æ

åˆ†æç”¨æˆ·å†å²è¡Œä¸ºï¼š

```python
class UserBehaviorAnalyzer:
    def analyze_pattern(self, user_id):
        # åˆ†æç”¨æˆ·è¡Œä¸ºæ¨¡å¼
        pass
```

## æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 1. ç¼“å­˜æœºåˆ¶

```python
from functools import lru_cache

@lru_cache(maxsize=1000)
def get_user_status(user_id):
    # ç¼“å­˜ç”¨æˆ·çŠ¶æ€
    pass
```

### 2. æ‰¹é‡å¤„ç†

```python
async def batch_analyze(messages):
    # æ‰¹é‡åˆ†æå¤šæ¡æ¶ˆæ¯
    tasks = [analyze_message(msg) for msg in messages]
    results = await asyncio.gather(*tasks)
    return results
```

### 3. é¢„è¿‡æ»¤

åœ¨è°ƒç”¨ LLM å‰è¿›è¡Œç®€å•è¿‡æ»¤ï¼š

```python
def quick_check(message_text):
    # ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼å¿«é€Ÿæ£€æµ‹æ˜æ˜¾çš„åƒåœ¾æ¶ˆæ¯
    spam_patterns = [
        r'åŠ å¾®ä¿¡.*é¢†å–',
        r'ç‚¹å‡»é“¾æ¥.*ä¼˜æƒ ',
        # ...
    ]
    return any(re.search(p, message_text) for p in spam_patterns)
```

## å®‰å…¨è€ƒè™‘

### 1. è¾“å…¥éªŒè¯

- éªŒè¯æ¶ˆæ¯é•¿åº¦
- è¿‡æ»¤ç‰¹æ®Šå­—ç¬¦
- é˜²æ­¢æ³¨å…¥æ”»å‡»

### 2. æƒé™æ£€æŸ¥

- éªŒè¯ Bot æƒé™
- æ£€æŸ¥ç”¨æˆ·æƒé™
- ç®¡ç†å‘˜ç™½åå•

### 3. API å¯†é’¥ä¿æŠ¤

- ä½¿ç”¨ç¯å¢ƒå˜é‡
- ä¸æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶
- å®šæœŸè½®æ¢å¯†é’¥

### 4. é€Ÿç‡é™åˆ¶

- é™åˆ¶ API è°ƒç”¨é¢‘ç‡
- é˜²æ­¢æ»¥ç”¨
- å®ç°é‡è¯•æœºåˆ¶

## ç›‘æ§å’Œæ—¥å¿—

### 1. æ—¥å¿—çº§åˆ«

- DEBUG: è¯¦ç»†è°ƒè¯•ä¿¡æ¯
- INFO: ä¸€èˆ¬ä¿¡æ¯ï¼ˆé»˜è®¤ï¼‰
- WARNING: è­¦å‘Šä¿¡æ¯
- ERROR: é”™è¯¯ä¿¡æ¯

### 2. å…³é”®æŒ‡æ ‡

- æ¶ˆæ¯å¤„ç†é€Ÿåº¦
- LLM API è°ƒç”¨æˆåŠŸç‡
- æ£€æµ‹å‡†ç¡®ç‡
- é”™è¯¯ç‡

### 3. å‘Šè­¦æœºåˆ¶

- API è°ƒç”¨å¤±è´¥
- æƒé™ä¸è¶³
- æœåŠ¡å¼‚å¸¸

## æµ‹è¯•ç­–ç•¥

### 1. å•å…ƒæµ‹è¯•

æµ‹è¯•å„ä¸ªæ¨¡å—çš„åŠŸèƒ½ï¼š

```python
# test_spam_detector.py
def test_extract_message_text():
    # æµ‹è¯•æ¶ˆæ¯æ–‡æœ¬æå–
    pass
```

### 2. é›†æˆæµ‹è¯•

æµ‹è¯•æ¨¡å—é—´çš„äº¤äº’ï¼š

```python
# test_integration.py
async def test_full_detection_flow():
    # æµ‹è¯•å®Œæ•´æ£€æµ‹æµç¨‹
    pass
```

### 3. ç«¯åˆ°ç«¯æµ‹è¯•

ä½¿ç”¨çœŸå® Telegram æ¶ˆæ¯æµ‹è¯•ï¼š

```bash
python test_bot.py
```

## æœªæ¥æ”¹è¿›æ–¹å‘

1. **å¤šè¯­è¨€æ”¯æŒ**: æ”¯æŒæ£€æµ‹å¤šç§è¯­è¨€çš„åƒåœ¾æ¶ˆæ¯
2. **è‡ªå­¦ä¹ **: æ ¹æ®åé¦ˆè‡ªåŠ¨ä¼˜åŒ–æ£€æµ‹è§„åˆ™
3. **å¯è§†åŒ–é¢æ¿**: Web ç•Œé¢æŸ¥çœ‹ç»Ÿè®¡å’Œé…ç½®
4. **æ›´å¤šæ£€æµ‹ç»´åº¦**: å›¾ç‰‡ã€è§†é¢‘ã€é“¾æ¥å†…å®¹
5. **åˆ†å¸ƒå¼éƒ¨ç½²**: æ”¯æŒå¤šå®ä¾‹ã€è´Ÿè½½å‡è¡¡
6. **æ’ä»¶ç³»ç»Ÿ**: å…è®¸ç”¨æˆ·è‡ªå®šä¹‰æ£€æµ‹æ’ä»¶

---

**è´¡çŒ®ä»£ç ï¼Ÿ** æ¬¢è¿æäº¤ Pull Requestï¼
